#!/usr/bin/env bash

comp_prefix=@OBJSDIR@
moddir=$(@CYGPATH_W@ $comp_prefix/finclude)
libdir=$(@CYGPATH_W@ $comp_prefix/lib)
version=@PACKAGE_VERSION@

usage()
{
    cat <<EOF
Usage: FoX-config [OPTION]

Known values for OPTION are:

  --libs		print library linking information
  --fcflags		print pre-processor and compiler flags
  --help		display this help and exit
  --version		display version information
EOF

    exit $1
}

FLAGS=both
while test $# -gt 0; do
    case "$1" in
    -*=*) optarg=`echo "$1" | sed 's/[-_a-zA-Z0-9]*=//'` ;;
    *) optarg= ;;
    esac

    case "$1" in
    --version)
	echo ${version}
	exit 0
	;;

    --help)
	usage 0
	;;

    --fcflags)
        FLAGS=FC
       	;;

    --libs)
        FLAGS=LD
       	;;

    --wxml)
        MODULES="$MODULES wxml common fsys"
        ;;
    --wcml)
        MODULES="$MODULES wcml wxml utils common fsys"
        ;;
    --sax)
        MODULES="$MODULES sax common fsys"
        ;;
    --dom)
        MODULES="$MODULES dom sax wxml common fsys"
        ;;

    *)
	usage
	exit 1
	;;
    esac
    shift
done

if [[ $MODULES = *fsys* ]]; then
  LIBS=$libdir/libfsys.@LIBEXT@
fi
if [[ $MODULES = *common* ]]; then
  LIBS="$libdir/libFoX_common.@LIBEXT@ $LIBS"
fi
if [[ $MODULES = *utils* ]]; then
  LIBS="$libdir/libFoX_utils.@LIBEXT@ $LIBS"
fi
if [[ $MODULES = *wxml* ]]; then
  LIBS="$libdir/libFoX_wxml.@LIBEXT@ $LIBS"
fi
if [[ $MODULES = *wcml* ]]; then
  LIBS="$libdir/libFoX_wcml.@LIBEXT@ $LIBS"
fi
if [[ $MODULES = *sax* ]]; then
  LIBS="$libdir/libFoX_sax.@LIBEXT@ $LIBS"
fi
if [[ $MODULES = *dom* ]]; then
  LIBS="$libdir/libFoX_dom.@LIBEXT@ $LIBS"
fi
if [ -z "$LIBS" ]; then
  LIBS="$libdir/libFoX_sax.@LIBEXT@ $libdir/libFoX_wcml.@LIBEXT@ $libdir/libFoX_wxml.@LIBEXT@ $libdir/libFoX_common.@LIBEXT@ $libdir/libfsys.@LIBEXT@"
fi

case $FLAGS in
  FC)
    echo @FC_MOD_FLAG@"$moddir"
    ;;
  LD)
    echo $LIBS
    ;;
  both)
    echo @FC_MOD_FLAG@"$moddir" $LIBS
esac 

exit 0
